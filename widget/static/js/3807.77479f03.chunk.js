"use strict";(self.webpackChunkembed_widget=self.webpackChunkembed_widget||[]).push([[3807],{33807:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var i=a(47313),s=a(65537),l=a(46417);const o=Array.from({length:5},((e,t)=>t+1));class r extends i.Component{constructor(e){super(e),this.handleClick=e=>{const{addRatings:t}=this.props;this.setState({activeIndex:e}),t(e)},this.handleMouseEnter=e=>{this.setState({hoverIndex:e})},this.handleMouseLeave=()=>{this.setState({hoverIndex:null})},this.state={activeIndex:null,hoverIndex:null}}render(){const{hoverIndex:e,activeIndex:t}=this.state;return(0,l.jsx)("div",{className:"t_rate_wrap",children:o.map(((a,i)=>(0,l.jsx)("div",{className:"t_star_ico_wrap".concat(a<=e?" t_h_active_":"").concat(a<=t?" t_active_":""),onClick:()=>this.handleClick(a),onMouseEnter:()=>this.handleMouseEnter(a),onMouseLeave:this.handleMouseLeave,children:(0,l.jsx)("div",{className:"t_star_ico tb__icon tb-star-outline",children:(0,l.jsx)("div",{})})},i)))})}}const n=r;var c=a(17739),d=a(98501),h=a(35179),u=a(46335),m=a(3671);const _=i.lazy((()=>Promise.all([a.e(9457),a.e(9010)]).then(a.bind(a,18748)))),p=e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase()),v=e=>{var t,a;let{wall:i,type:s,onClosePopUp:o}=e;return(0,l.jsx)("div",{className:"t_modal_content",children:(0,l.jsxs)("div",{className:"t_s_wrap",children:[(0,l.jsx)("img",{className:"t_s_icon_",src:"".concat(d.do,"/media/icons/").concat(s,"-icon.svg"),height:80,width:80,alt:""}),"check"==s?(0,l.jsx)("div",{className:"t_s_title",children:"Thanks for Your Efforts!"}):null,(0,l.jsx)("div",{className:"t_s_desc",children:null!==i&&void 0!==i&&null!==(t=i.SnapUp)&&void 0!==t&&t.Form.status?null===i||void 0===i||null===(a=i.SnapUp)||void 0===a?void 0:a.Form.successText:"Thank you for sharing your amazing content with us."}),(0,l.jsx)("div",{className:"t_f_close_wrap",children:(0,l.jsx)("button",{className:"t_f_p_btn",onClick:o,children:"Close"})})]})})},g=e=>{let{logo:t}=e;return t?(0,l.jsx)("div",{className:"t_m_logo_w",children:(0,l.jsx)("img",{className:"t_m_logo",src:t,height:20,width:130,alt:""})}):null};class x extends i.Component{constructor(e){var t,a;super(e),this.handleNext=e=>this.setState({submitPost:!1}),this.onShowCloseSubmitPicPopUp=e=>{const{isOpen:t}=this.state;this.setState({isOpen:!t})},this.updateImageWithData=e=>{const{upload_image:t}=this.state;t&&t.length<20&&(t.push(e),this.setState({upload_image:t}))},this.onClickToaddMore=e=>{const{upload_image:t}=this.state;t&&t.length<20?(t.push({file:null,caption:null,review:"",rating:0,error:!1,type:1,thumb_file:"",videoPath:""}),this.setState({isAddMoreActive:!0,upload_image:t,isActiveIndex:0==t.length||1==t.length?0:parseInt(t.length)-1,step:1,submitError:!1,errorClickMore:!1})):t.length>=20&&this.setState({errorClickMore:!0})},this.onClickToUpdateMoreStep=e=>t=>{const{isAddMoreActive:a,isActiveIndex:i,upload_image:s}=this.state;a&&s[i]&&s.splice(i,1),this.setState({isAddMoreActive:!1,upload_image:s,step:e,isActiveIndex:s&&s.length>0&&parseInt(s.length)-1>0?parseInt(s.length)-1:0,errorClickMore:!1})},this.onSubmitPostData=e=>{const{name:t,email:a,upload_image:i,is_terms_check:s,tandc:l,rateProduct:o,reviewTitle:r,review:n,layout:d,captionError:u}=this.state,{wallId:_,modalPop:v,wall:g,feeds:x}=this.props;if(this.setState({submitError:!1}),l&&(null===t||void 0===t?void 0:t.length)>0&&(null===a||void 0===a?void 0:a.length)>0&&p(a)&&!a.includes("mailinator")&&l&&(1==d&&o>0&&(!h.ig||r)||2==d)&&(null===n||void 0===n?void 0:n.length)>0&&!u){this.setState({apiRequest:!0});var b=!!window.ugcSuite||!!h.Y1,w={};b&&x&&x.length>0&&x.map((e=>{e&&e.Network&&Object.keys(e.Network).length&&29==e.Network.id&&e.value1&&(w={feedId:e.value1})}));let e=[];i&&i.length>0?i.map((t=>e.push({...t}))):e=[{video:"",type:1,mediaHeight:"",mediaWidth:"",thumbnail:""}];const l={wallId:null!==g&&void 0!==g&&g.ThemeInfo.wallId?null===g||void 0===g?void 0:g.ThemeInfo.wallId:_,name:t,email:a,media:e,ONSITE_TOKN:v.ONSITE_TOKN,...w,caption:n,rating:o,title:2==d?" ":r};[104746].includes(null===g||void 0===g?void 0:g.ThemeInfo.ownerId)&&(l.is_terms_check=s),(0,m.uM)(l).then((e=>{this.setState({step:3,apiRequest:!1},(()=>setTimeout((()=>{c.FH?window.location.reload():this.props.onSitePopup(!1)}),5e3)),document.querySelector("html").style.overflow="auto")})).catch((e=>{const{message:t}=e.toJSON();t&&this.setState({submitError:!0,submitErrorMessage:t,apiRequest:!1}),console.error(e)}))}else""!=this.state.review&&0!=this.state.review.trim().length||this.setState({captionError:!0,apiRequest:!1}),null!=this.state.name&&0!=this.state.name.trim().length||this.setState({nameError:!0,apiRequest:!1}),null!=this.state.email&&0!=this.state.email.trim().length&&p(this.state.email)&&!a.includes("mailinator")||this.setState({emailError:!0,apiRequest:!1}),0==o&&this.setState({rateProductError:!h.bX}),null!=this.state.reviewTitle&&0!=this.state.reviewTitle.trim().length||this.setState({reviewTitleError:!0,apiRequest:!1})},this.addCaption=e=>{String(e.target.value).length<=500?this.setState({review:e.target.value,captionError:!1}):this.setState({captionError:!0})},this.addReview=e=>t=>{const{upload_image:a}=this.state;a&&a[e]&&(a[e].review=t.target.value,a[e].caption="",a[e].error=!1,this.setState({upload_image:a}))},this.addRatings=e=>this.setState({rateProduct:e,rateProductError:!1}),this.onChangeReviewTitle=e=>this.setState({reviewTitle:e.target.value,reviewTitleError:!1}),this.addPostImage=(e,t,a,i,s)=>{let{upload_image:l}=this.state;const o={video:e,type:a,mediaHeight:i,mediaWidth:s,thumbnail:t};l.push(o),l.length>20&&(l.length=20),this.setState({upload_image:l,isActiveIndex:l.length+1})},this.onClickToRemove=e=>{const{upload_image:t}=this.state;if(t&&t.length>0){const a=t.filter((t=>t.video!=e.video));this.setState({upload_image:a,errorClickMore:!1,isActiveIndex:a.length+1,removedFile:e})}},this.onClickToImageRemove=e=>t=>{const{upload_image:a}=this.state;a&&a[e]&&(a[e].file=null,a[e].thumb_file="",a[e].videoPath="",a[e].type=1,a[e].ext=null,a[e].size=0,a[e].fileName=null,a[e].mediaHeight=0,a[e].mediaWidth=0,this.setState({upload_image:a}),(0,u.AB)(2))},this.onClickToEdit=e=>t=>this.setState({isActiveIndex:e,step:1}),this.onTextName=e=>{this.setState({name:e.target.value,nameError:!1},(()=>{null!=this.state.name&&0!=this.state.name.length||this.setState({nameError:!0})}))},this.onTextEmail=e=>{this.setState({email:e.target.value,emailError:!1},(()=>{null!=this.state.email&&0!=this.state.email.length&&p(this.state.email)&&!this.state.email.includes("mailinator")||this.setState({emailError:!0})}))},this.onUpdatetandc=e=>this.setState({tandc:!this.state.tandc}),this.onClosePopUp=()=>{this.props.onSitePopup(!1),document.querySelector("html").style.overflow="auto"},this.termsCheck=e=>this.setState({is_terms_check:e}),this.uploadErrorCallback=e=>{this.setState({uploadError:e},(()=>{setTimeout((()=>{this.setState({uploadError:""})}),5e3)}))},this.backStepFun=()=>this.setState({step:1}),this.state={submitPost:!0,isOpen:!0,step:1,wall_id:null,name:"",email:"",upload_image:[],tandc:!0,nameError:!1,emailError:!1,submitErrorMessage:null,apiRequest:!1,isActiveIndex:0,isAddMoreActive:!1,submitError:!1,is_terms_check:0,errorClickMore:!1,uploadError:"",rateProduct:0,reviewTitle:"",review:"",rateProductError:!1,reviewTitleError:!1,captionError:!1,layout:(null===e||void 0===e||null===(t=e.wall)||void 0===t||null===(a=t.SnapUp)||void 0===a?void 0:a.Form.type)||1,removedFile:{}}}render(){const{isActiveIndex:e,step:t,upload_image:a,isAddMoreActive:s,name:o,email:r,tandc:c,nameError:u,emailError:m,apiRequest:x,submitError:b,submitErrorMessage:w,errorClickMore:f,uploadError:N,reviewTitle:j,review:S,rateProductError:k,reviewTitleError:E,captionError:y,layout:C,removedFile:T}=this.state,{wall:I,modalPop:M,isFreeAdsStatus:P}=this.props,{Form:A}=I.SnapUp,R={backgroundColor:null!==A&&void 0!==A&&A.background.color?null===A||void 0===A?void 0:A.background.color:null,backgroundImage:null!==A&&void 0!==A&&A.background.url?"url(".concat(null===A||void 0===A?void 0:A.background.url,")"):null},{onClosePopUp:F}=this;return(0,l.jsx)("div",{className:"t_modal".concat(P?" t_brand_":""),children:(0,l.jsx)("div",{className:"t_modal_wrap",style:R,children:Object.keys((null===I||void 0===I?void 0:I.SnapUp)||{}).length&&A.status?(0,l.jsx)("div",{className:"t_modal_container",children:3==t?(0,l.jsx)(v,{wall:I,onClosePopUp:F,type:"check"}):(0,l.jsxs)("div",{className:"t_modal_content",children:[(0,l.jsx)(g,{logo:null===A||void 0===A?void 0:A.logo.url}),(0,l.jsx)("div",{className:"t_m_close_btn tb__icon tb-close-alt",onClick:F,children:(0,l.jsx)("div",{})}),A.title?(0,l.jsx)("div",{className:"t_m_title",children:A.title}):null,""!=A.subTitle?(0,l.jsx)("div",{className:"t_m_subtitle",children:A.subTitle}):null,1==C?(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsx)(n,{isActiveIndex:e,onClickToUpdateMoreStep:this.onClickToUpdateMoreStep,isAddMoreActive:s,item:a[e],addRatings:this.addRatings}),k?(0,l.jsx)("div",{className:"t_f_error t_text_center",children:" * Rating is required."}):null]}):null,1==C&&h.ig?(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsxs)("div",{className:"t_label_",children:["Review Title ",(0,l.jsx)("div",{className:"t_t_danger",children:"*"})]}),(0,l.jsx)("input",{type:"text",className:"t_from_input ".concat(E?"t_f_invalid":""),placeholder:"Enter review title",onChange:this.onChangeReviewTitle,value:j}),E?(0,l.jsx)("div",{className:"t_f_error",children:" * Review Title is required."}):null]}):null,(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsxs)("div",{className:"t_label_",children:[2==C?"Caption":"Review","  ",(0,l.jsx)("div",{className:"t_t_danger",children:"*"})]}),(0,l.jsx)("textarea",{className:"t_from_textarea ".concat(y?"t_f_invalid":""),placeholder:"Write your ".concat(2==C?"caption":"review"," here"),value:S,onChange:this.addCaption}),y?(0,l.jsxs)("div",{className:"t_f_error",children:[" * ",String(S).length<=0?"".concat(2==C?"Caption":"Review"," is required."):"".concat(2==C?"Caption":"Review"," limit of 500 exceeded!")]}):null]}),(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsx)("div",{className:"t_label_",children:"Picture/Video (optional)"}),(0,l.jsxs)("div",{className:"t_f_upload",children:[a&&a.length>0?a&&a.map(((e,t)=>e.thumbnail?(0,l.jsxs)("div",{className:"t_m_up_img_wrap",onClick:this.onClickToEdit(t),children:[e.thumbnail?(0,l.jsxs)("div",{className:"t_m_up_img_in",children:[(0,l.jsx)("img",{className:"t_m_up_img",src:e.thumbnail,height:80,width:80,alt:""}),[3,5].includes(e.type)?(0,l.jsx)("div",{className:"t_m_vi_ico tb__icon tb-play",children:(0,l.jsx)("div",{})}):null]}):null,(0,l.jsx)("div",{className:"t_m_remove_btn tb__icon tb-close-alt",onClick:()=>this.onClickToRemove(e,t),children:(0,l.jsx)("div",{})})]},t):null)):null,(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)("div",{className:"t_m_upload",children:"Loading..."}),children:(0,l.jsx)(_,{updateImageWithData:this.updateImageWithData,isActiveIndex:e,addPostImage:this.addPostImage,ONSITE_TOKN:M.ONSITE_TOKN,uploadErrorCallback:this.uploadErrorCallback,upload_image:a,onClickToUpdateMoreStep:this.onClickToUpdateMoreStep,removedFile:T})})]}),N?(0,l.jsx)("div",{className:"t_f_error",children:N}):null]}),(0,l.jsxs)("div",{className:"t_row_",children:[(0,l.jsx)("div",{className:"t_col_",children:(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsxs)("div",{className:"t_label_",children:["Name  ",(0,l.jsx)("div",{className:"t_t_danger",children:"*"})]}),(0,l.jsx)("input",{type:"text",className:"t_from_input ".concat(u?"t_f_invalid":""),placeholder:"Enter Your name",onChange:this.onTextName,value:o}),u?(0,l.jsx)("div",{className:"t_f_error",children:" Name is required."}):null]})}),(0,l.jsx)("div",{className:"t_col_",children:(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsxs)("div",{className:"t_label_",children:["Email  ",(0,l.jsx)("div",{className:"t_t_danger",children:"*"})]}),(0,l.jsx)("input",{type:"text",className:"t_from_input ".concat(m?"t_f_invalid":""),placeholder:"Enter you email",onChange:this.onTextEmail,value:r}),m?(0,l.jsxs)("div",{className:"t_f_error",children:[" ",0==String(r).trim().length?"Email is required.":p(r)?"":"Enter valid email."]}):null]})})]}),[104746].includes(I.ThemeInfo.ownerId)?(0,l.jsxs)("div",{className:"t_f_check_inline",children:[(0,l.jsx)("input",{type:"checkbox",id:"t_accept",className:"t_from_check",onChange:e=>this.termsCheck(e.target.checked?1:0)}),(0,l.jsxs)("div",{className:"t_f_label_wrap",children:[(0,l.jsx)("label",{className:"t_check_label_",htmlFor:"t_accept",children:"I agree to CALM using my story for marketing purposes --"}),(0,l.jsx)("a",{href:A.termsLink,className:"t_tc_link",target:"_blank",children:"click for more information on how your story will be used."})]})]}):(0,l.jsxs)("div",{className:"t_f_group",children:[(0,l.jsxs)("div",{className:"t_f_check_inline",children:[(0,l.jsx)("input",{type:"checkbox",id:"t_accept",className:"t_from_check",value:"accept",onChange:this.onUpdatetandc,checked:c}),(0,l.jsxs)("label",{className:"t_check_label_",htmlFor:"t_accept",children:["By clicking on Submit, you are agreeing to our ",(0,l.jsx)("a",{href:"".concat(d.ZS).concat(h.Jx?"on-site-uploads-content-rights/":"snapup-content-rights/"),className:"t_tc_link",target:"_blank",children:"terms and conditions"})," *"]})]}),0==c?(0,l.jsx)("div",{className:"t_f_error",children:"* Please agree to the terms and conditions to submit your media."}):null]}),b?(0,l.jsx)("div",{className:"t_f_group",children:(0,l.jsxs)("div",{className:"t_f_error",children:["* ",w||"Please check complete details."]})}):null,(0,l.jsx)("div",{className:"t_f_group t_text_center",children:(0,l.jsx)("div",{className:"t_f_p_btn ".concat(x?" t_f_btn_spinner":""),onClick:this.onSubmitPostData,children:A.button.text})}),2==t?(0,l.jsx)("div",{className:"t_f_group t_text_center",children:(0,l.jsx)("div",{className:"t_f_s_btn",onClick:this.backStepFun,children:"Back"})}):null,f?(0,l.jsx)("div",{className:"t_f_error",children:"* Max 20 posts are allowed."}):null]})}):null})})}}const b=(0,s.$j)((e=>(void 0!=e.modalPop&&1==e.modalPop.onSiteIsShowPopUp&&(document.querySelector("html").style.overflow="hidden"),{modalPop:e.modalPop})),(e=>({onSitePopup:t=>e((0,m.wg)(t)),onsiteTokenUpdate:t=>e((0,m.q3)(t))})))(x)},46335:(e,t,a)=>{a.d(t,{$t:()=>w,AB:()=>d,E6:()=>T,Fx:()=>b,GF:()=>M,P:()=>f,RD:()=>v,Rr:()=>h,Sy:()=>x,ad:()=>I,hd:()=>g,i1:()=>m,ok:()=>S,qE:()=>_,sy:()=>j,u$:()=>N,uB:()=>p,uu:()=>C,w5:()=>u});var i=a(35179),s=a(98501),l=a(70656),o=a(93517);let r=[],n=!1;const c=new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(i.UA),Productdomain:i.yM}),d=e=>{var t;return null===(t=document.getElementById("tb_onsite_btn_id"))||void 0===t?void 0:t.classList.toggle("tb_onsite_btn_disabled",1===e)},h=e=>{var t,a;return null===(t=(a={1:()=>window.onShowDemoPost(1),2:()=>window.hendleFeeds("addFeeds"),3:()=>window.hendleFeeds("manageFeeds")})[e])||void 0===t?void 0:t.call(a)},u=e=>{const t=new Date(1e3*e);return"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear())},m=()=>Math.floor(1e4*Math.random()).toString().padStart(4,"0"),_=e=>{try{r.push(e)}catch(t){console.log(t)}},p=e=>e&&""!==e&&!e.includes("ui-avatars"),v=e=>{if(!e)return"0 Byte";const t=Math.floor(Math.log(e)/Math.log(1024));return{size:Math.round(e/Math.pow(1024,t),2),sizeText:["Bytes","KB","MB","GB","TB"][t]}},g=e=>e.startsWith("http://")||e.startsWith("https://")?e:"https://"+e,x=e=>{const t=Date.now()-1e3*e;if(t<6e4)return"just now";const a=[{label:"year",ms:31536e6},{label:"month",ms:2592e6},{label:"week",ms:6048e5},{label:"day",ms:864e5},{label:"hour",ms:36e5},{label:"minute",ms:6e4}].find((e=>{let{ms:a}=e;return t>=a})),i=Math.floor(t/a.ms);return"".concat(i," ").concat(a.label).concat(i>1?"s":""," ago")},b=e=>{try{return null!==e&&void 0!==e&&e.includes("http")?[...new Set(e.match(/(((ftp|https?):\/\/)[\w@:%_\+.~#?&//=]+)/g))].reduce(((e,t)=>e.replaceAll(t,'<a class="text_links_" role="link" target="_blank" href="'.concat(t,'">').concat(t,"</a>"))),e):e}catch{return e}},w=()=>["".concat(s.ZS),"Website Widget"],f=e=>e&&String(e)?unescape(e).split("/").pop().split("/").slice(-1).join().split(".").shift():"",N=["localhost","widget","wall_id="].every((e=>(0,i.F_)(e)))?"taggbox_main":i.Jx||["".concat(i.l,".").concat(i.wq),"".concat(i.l).concat(i.Bu).concat(i.wq),"".concat(i.l,"s.").concat(i.wq)].some((e=>(0,i.F_)(e)))?"tag_main__root":i.ig?"taggShopRoot":"taggbox_main",j=e=>{const t=Math.floor(Math.log10(e)/3)||0;return t?+(e/Math.pow(1e3,t)).toFixed(0)+["","K","M","B","T"][t]:e},S=e=>i.Jx?e:atob(e),k=e=>{if(null===(a=e)||void 0===a?void 0:a.startsWith("#")){const t=parseInt(e.slice(1),16);return{r:t>>16&255,g:t>>8&255,b:255&t}}{var t;const a=(null===e||void 0===e||null===(t=e.match(/\d+/g))||void 0===t?void 0:t.map(Number))||[0,0,0];return{r:a[0],g:a[1],b:a[2]}}var a},E=e=>{const{r:t,g:a,b:i}=k(e);return Math.sqrt((255-t)**2+(255-a)**2+(255-i)**2)<=30},y=e=>{const{r:t,g:a,b:i}=k(e);return Math.sqrt((t-50)**2+(a-50)**2+(i-50)**2)<50},C=(e,t)=>{var a;null!==(a=e)&&void 0!==a&&a.startsWith("rgba")&&(e="#000000");const i=(e,t)=>t.some((t=>null===e||void 0===e?void 0:e.includes(t))),s=e=>i(e,["ffffff","255, 255, 255","#fff"]),l=e=>i(e,["000000","0, 0, 0","#000"]),[o,r]=[E(e),y(e)],[n,c]=[E(t),y(t)];return o&&n||s(e)&&s(t)?"#000000":r&&c||l(e)&&l(t)?"#ffffff":e},T=(e,t,a)=>e&&e.length>0?e.findIndex((e=>e.id===t)):a,I=()=>{try{const{wall:e}=l.Z.getState().appData,{webId:t,wallId:a,ownerId:s}=e.ThemeInfo;n||(window.addEventListener("beforeunload",(()=>{if(0===r.length)return;const e=r.reduce(((e,t)=>e+t),0);e>0?fetch(i.Zl,{method:"POST",headers:c,body:JSON.stringify({action:1,model:null!==o.mV&&void 0!==o.mV&&o.mV.includes("website")?"website":"wall",playCount:r.length,wall:i.ig?t:a,playTime:e,owner:s}),keepalive:!0}).finally((()=>(r=[],n=!1))):(r=[],n=!1)})),n=!0)}catch(e){console.error(e)}},M=e=>new Promise(((t,a)=>Object.assign(new Image,{onload:function(){t({width:this.naturalWidth,height:this.naturalHeight})},onerror:e=>a(new Error("Image loading error: ".concat(e.message))),src:e})))}}]);